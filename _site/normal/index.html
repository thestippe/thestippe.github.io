<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The Normal and Student-T model | Data Perspectives</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="The Normal and Student-T model" />
<meta name="author" content="Stippe" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The most common model, and one of its evolutions" />
<meta property="og:description" content="The most common model, and one of its evolutions" />
<link rel="canonical" href="http://localhost:4000/normal/" />
<meta property="og:url" content="http://localhost:4000/normal/" />
<meta property="og:site_name" content="Data Perspectives" />
<meta property="og:image" content="http://localhost:4000/docs/assets/images/normal/norm_xkcd.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-20T00:00:00+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/docs/assets/images/normal/norm_xkcd.jpg" />
<meta property="twitter:title" content="The Normal and Student-T model" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Stippe"},"dateModified":"2023-08-20T00:00:00+02:00","datePublished":"2023-08-20T00:00:00+02:00","description":"The most common model, and one of its evolutions","headline":"The Normal and Student-T model","image":"http://localhost:4000/docs/assets/images/normal/norm_xkcd.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/normal/"},"url":"http://localhost:4000/normal/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Data Perspectives" />

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>
</head>
<body><header class="site-header">

<div>
  <div class="wrapper" style="display:flex;"><a href="/"><img class="site-masthead" src="/docs/assets/images/logo_dp.png" alt="Data Perspectives" /></a><nav class="site-nav" style="display:flex;">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about">About me</a><a class="page-link" href="/index">Home</a><a class="page-link" href="/notes">List of the notes</a><a class="page-link" href="/links">Some useful resources</a></div>
      </nav></div>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The Normal and Student-T model</h1>
    <p class="post-meta"><time class="dt-published" datetime="2023-08-20T00:00:00+02:00" itemprop="datePublished">
        Aug 20, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Up to this moment our task was to model some random discrete variables. 
In this post we will look at some continuous model, and the most common one
is by far the Normal model.
Let us try and see its main features by looking at some physical data.</p>

<h2 id="neutrinos-and-the-normal-model">Neutrinos and the Normal model</h2>
<p>I downloaded the zip file from <a href="https://icecube.wisc.edu/data-releases/2018/07/icecube-data-from-2008-to-2017-related-to-analysis-of-txs-0506056/">this page</a>
of the <a href="https://it.wikipedia.org/wiki/IceCube">IceCube</a> experiment website.
In the zip you will find many files, let us look at the one named “events_IC86b.txt”</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">./events_IC86b.txt</span><span class="sh">'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: right">MJD</th>
      <th style="text-align: right">Ra_deg</th>
      <th style="text-align: right">Dec_degm</th>
      <th style="text-align: right">Unc_deg</th>
      <th style="text-align: right">log10(Ereco)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">56067.1</td>
      <td style="text-align: right">76.76</td>
      <td style="text-align: right">5.38</td>
      <td style="text-align: right">0.56</td>
      <td style="text-align: right">3.68</td>
    </tr>
    <tr>
      <td style="text-align: right">56067.4</td>
      <td style="text-align: right">75.58</td>
      <td style="text-align: right">4.11</td>
      <td style="text-align: right">0.81</td>
      <td style="text-align: right">3.09</td>
    </tr>
    <tr>
      <td style="text-align: right">56068.9</td>
      <td style="text-align: right">77.12</td>
      <td style="text-align: right">3.24</td>
      <td style="text-align: right">0.49</td>
      <td style="text-align: right">3.1</td>
    </tr>
    <tr>
      <td style="text-align: right">56071.2</td>
      <td style="text-align: right">75.76</td>
      <td style="text-align: right">6.91</td>
      <td style="text-align: right">0.51</td>
      <td style="text-align: right">3.01</td>
    </tr>
    <tr>
      <td style="text-align: right">56078.5</td>
      <td style="text-align: right">78.53</td>
      <td style="text-align: right">6.97</td>
      <td style="text-align: right">0.8</td>
      <td style="text-align: right">3.6</td>
    </tr>
  </tbody>
</table>

<p>This dataset collects the characteristics of some muon (a kind of elementary particle)
observed from the IceCube experiment in the South Pole.
For the moment we are only interested in the last column, which represents
the logarithm of the reconstructed muon energy.</p>

<p><img src="/docs/assets/images/normal/neutrinos_hist.jpg" alt="muon log energy" /></p>

<p>We only observe positive values, but the logarithm of a positive quantity is a real quantity, which can take any value.
Moreover the data looks roughly symmetric, so we can try and use a Normal model:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">normal_model</span><span class="p">:</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Normal</span><span class="p">(</span><span class="sh">'</span><span class="s">mu</span><span class="sh">'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Gamma</span><span class="p">(</span><span class="sh">'</span><span class="s">sigma</span><span class="sh">'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Normal</span><span class="p">(</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">log10(Ereco)</span><span class="sh">'</span><span class="p">])</span>
    <span class="n">trace_normal</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nf">sample</span><span class="p">()</span>
<span class="n">az</span><span class="p">.</span><span class="nf">plot_trace</span><span class="p">(</span><span class="n">trace_normal</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/normal/trace_neutrinos_normal.jpg" alt="Normal model trace" /></p>

<p>The trace looks fine, let us check if our model correctly reproduces the data:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">normal_model</span><span class="p">:</span>
   <span class="n">ppc_normal</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nf">sample_posterior_predictive</span><span class="p">(</span><span class="n">trace_normal</span><span class="p">)</span>
<span class="n">az</span><span class="p">.</span><span class="nf">plot_ppc</span><span class="p">(</span><span class="n">ppc_normal</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/normal/ppc_neutrinos_normal.jpg" alt="Normal model ppc" /></p>

<p>Our model is clearly unable to reproduce the data.
Our dataset contains some events which are located far away from $1\sigma$.
On the other hand, the normal pdf drops to zero already for $3\sigma\,.$
We should look for a more general model, which allows for a slower decrease of the pdf or,
in the statistical jargon we should look for a distribution with heavier tails than the normal one.
We can try a Student-t model, which is a generalization of the Normal distribution.
This distribution has an additional parameter $\nu\,,$ which allows to tune the heaviness of the tails 
and such that, in the limit $\nu \rightarrow \infty$, it corresponds to the Normal distribution.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">t_model</span><span class="p">:</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Normal</span><span class="p">(</span><span class="sh">'</span><span class="s">mu</span><span class="sh">'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Gamma</span><span class="p">(</span><span class="sh">'</span><span class="s">sigma</span><span class="sh">'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nc">Exponential</span><span class="p">(</span><span class="sh">'</span><span class="s">nu</span><span class="sh">'</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nc">StudentT</span><span class="p">(</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="n">nu</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">log10(Ereco)</span><span class="sh">'</span><span class="p">])</span>
    <span class="n">trace_t</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nf">sample</span><span class="p">()</span>
<span class="n">az</span><span class="p">.</span><span class="nf">plot_trace</span><span class="p">(</span><span class="n">trace_t</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/normal/trace_neutrinos_t.jpg" alt="Student-t model trace" /></p>

<p>In our case we have $\nu \approx 3\,,$ which suggests that the Normal distribution
is not well suited to fit the data.
Let us now check if this model improves the fit:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">t_model</span><span class="p">:</span>
   <span class="n">ppc_t</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="nf">sample_posterior_predictive</span><span class="p">(</span><span class="n">trace_t</span><span class="p">)</span>
<span class="n">az</span><span class="p">.</span><span class="nf">plot_ppc</span><span class="p">(</span><span class="n">ppc_t</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/normal/ppc_neutrinos_t.jpg" alt="Student-t model ppc" /></p>

<p>Now the black line is always inside the blue region, so the fit highly improved.</p>


  </div><a class="u-url" href="/normal/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Stippe</li>
          <li><a class="u-email" href="mailto:smaurizio87@protonmail.com">smaurizio87@protonmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://twitter.com/SteffPy" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://stackoverflow.com/users/11065831/stefano" target="_blank" title="stackoverflow">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#stackoverflow"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://github.com/thestippe/" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>

