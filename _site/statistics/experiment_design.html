<!DOCTYPE html>
<html lang="en"><head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-W9G73E5P44"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-W9G73E5P44');
</script>
          <link rel="icon" 
                type="image/png" 
                href="/docs/assets/images/dp_icon.png">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Experiment analysis | Data Perspectives</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Experiment analysis" />
<meta name="author" content="Data-perspectives" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to design and analyze experiment" />
<meta property="og:description" content="How to design and analyze experiment" />
<link rel="canonical" href="http://localhost:4000/statistics/experiment_design" />
<meta property="og:url" content="http://localhost:4000/statistics/experiment_design" />
<meta property="og:site_name" content="Data Perspectives" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-02T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Experiment analysis" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Data-perspectives"},"dateModified":"2024-06-02T00:00:00+00:00","datePublished":"2024-06-02T00:00:00+00:00","description":"How to design and analyze experiment","headline":"Experiment analysis","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/statistics/experiment_design"},"url":"http://localhost:4000/statistics/experiment_design"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Data Perspectives" />


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>
<a rel="me" href="https://vis.social/@thestippe" style="display: none;">Mastodon</a>
<link rel="manifest" href="manifest.json">
</head>
<body>

        <div id='upperBar'><header class="site-header">

        <div id='upperBarr'>
        <script src="https://d3js.org/d3.v7.js"></script>
                <div class="wrapper" style="display:flex;"><ul hidden='hidden' id="postList"><li>
                        Nonparametric models;/statistics/nonparametric_intro;1
                </li><li>
                        Synthetic control;/statistics/synthetic_control;2
                </li><li>
                        Difference in difference;/statistics/difference_in_differences;3
                </li><li>
                        Instrumental variable regression;/statistics/instrumental_variable;4
                </li><li>
                        Randomized controlled trials;/statistics/randomized;5
                </li><li>
                        Causal inference;/statistics/causal_intro;6
                </li><li>
                        Experiment analysis;/statistics/experiment_design;7
                </li><li>
                        Introduction to Extreme Values theory;/statistics/extreme_intro;8
                </li><li>
                        Application of survival analysis with discrete times;/statistics/survival_example_2;9
                </li><li>
                        Application of survival analysis 1;/statistics/survival_example;10
                </li><li>
                        Introduction to survival analysis;/statistics/survival_analysis;11
                </li><li>
                        Random models and mixed models;/statistics/random_models;12
                </li><li>
                        Hierarchical models and meta-analysis;/statistics/hierarchical_metaanalysis;13
                </li><li>
                        Hierarchical models;/statistics/hierarchical_models;14
                </li><li>
                        Poisson regression;/statistics/poisson_regression;15
                </li><li>
                        Logistic regression;/statistics/logistic_regression;16
                </li><li>
                        Robust linear regression;/statistics/robust_regression;17
                </li><li>
                        Multi-linear regression;/statistics/multivariate_regression;18
                </li><li>
                        Linear regression with binary input;/statistics/regression_binary_input;19
                </li><li>
                        Introduction to the linear regression;/statistics/regression;20
                </li><li>
                        Model comparison, cont.;/statistics/model_averaging_cont;21
                </li><li>
                        Model comparison;/statistics/model_averaging;22
                </li><li>
                        Reparametrizing your model;/statistics/reparametrization;23
                </li><li>
                        Predictive checks;/statistics/predictive_checks;24
                </li><li>
                        Trace inspection;/statistics/trace_inspection;25
                </li><li>
                        Introduction to the Bayesian workflow;/statistics/bayesian_workflow;26
                </li><li>
                        Mixture models;/statistics/mixture;27
                </li><li>
                        Multidimensional distributions;/statistics/categories;28
                </li><li>
                        The Gaussian model;/statistics/reals;29
                </li><li>
                        The Negative Binomial model;/statistics/negbin;30
                </li><li>
                        The Poisson model;/statistics/poisson;31
                </li><li>
                        The Beta-Binomial model;/statistics/betabin;32
                </li><li>
                        Section introduction;/statistics/simple_models_intro;33
                </li><li>
                        Some notation about probability;/statistics/probability_reminder;34
                </li><li>
                        How does MCMC works;/statistics/mcmc_intro;35
                </li><li>
                        Introduction to Bayesian inference;/statistics/bayes_intro;36
                </li><li>
                        An overview to statistics;/statistics/preface;37
                </li><li>
                        The Gestalt principles;/dataviz/gestalt;38
                </li><li>
                        Design tricks;/dataviz/design-introduction;39
                </li><li>
                        How to choose a color map;/dataviz/palettes-introduction;40
                </li><li>
                        Introduction to color perception;/dataviz/color-introduction;41
                </li><li>
                        Drawing is redrawing;/dataviz/gender-economist;42
                </li><li>
                        Visual queries;/dataviz/visual-queries;43
                </li><li>
                        Channel effectiveness;/dataviz/effectiveness;44
                </li><li>
                        Evolutions of the line chart;/dataviz/linechart-evolution;45
                </li><li>
                        Beyond the 1D scatterplot;/dataviz/scatterplot-evolution;46
                </li><li>
                        Perception;/dataviz/perception;47
                </li><li>
                        Fundamental charts;/dataviz/fundamental-charts;48
                </li><li>
                        Marks and channels;/dataviz/marks-channels;49
                </li><li>
                        Data abstraction;/dataviz/data-types;50
                </li><li>
                        Data visualization;/dataviz/dataviz;51
                </li></ul>
                        <div style="display:flex">
                  <a href="/statistics/extreme_intro" class="prev">&#8249;</a>
                  
                                <a href="/"><img class="site-masthead" src="/docs/assets/images/logo_dp.png" alt="Data Perspectives" id="logo" /></a><div id='searchNav' style="flex;">
                                        <input type="search" id="search_0" class="searchBar" onkeydown="searchText()" placeholder="Search">
                                </div>

                                <div hidden='hidden' id="search_focus">0</div>



                        </div><nav class="site-nav" style="display:flex;">
                                <input type="checkbox" id="nav-trigger" class="nav-trigger" />
                                <label for="nav-trigger">
                                        <span class="menu-icon">
                                                <svg viewBox="0 0 18 15" width="18px" height="15px">
                                                        <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
                                                </svg>
                                        </span>
                                </label>

                                <div class="trigger"><a  class="page-link" href="/about">About me</a><a  class="page-link" href="/links">Resources</a>
                                <a href="/statistics/" class="page-link">Up</a>
                                
                                </div>
                        </nav>
                  <a href="/statistics/causal_intro" class="next">&#8250;</a>
                  
        </div>


        <script src="/docs/assets/javascript/search.js">
        </script>
                </div>

</header>
<div class="progress-container">
    <div class="progress-bar" id="myBar"></div>
    </div>
        </div>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
          <div id='topPage'></div>
        <a href='/index'>
<img src="/docs/assets/images/background_resized.webp" alt="backround" style="margin:auto;display:block;width:1200px">

</a>
    <h1 class="post-title p-name" itemprop="name headline">Experiment analysis</h1>
    <p class="post-meta"><time class="dt-published" datetime="2024-06-02T00:00:00+00:00" itemprop="datePublished">
        Jun 2, 2024
      </time></p>
    <p class="post-meta"> Reading time: <span class="reading-time" title="Estimated read time">
  
  8&prime;
</span>
</p>
  </header>
  <br>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Experimental design was developed by Fisher in the context of agriculture,
with the aim to better make decisions based on experimental data.
Nowadays experimental design is applied in many different fields,
but unfortunately there aren’t many textbook which treat this
topic from a Bayesian perspective.
The advantage of a Bayesian treatment is clear if you consider
that, often, collective data requires a big effort.
As an example, running an experiment in the agriculture
may take months, so it is crucial to extract as much information as possible
from every single datum.
The reason for sticking to the traditional data analysis approaches
might be due to the fact that Fisher had a very strong positions
against the Bayesian statistics, or maybe because most of the available
software is based on Fisher’s models.
It is however very easy to build Bayesian models for this kind
of application, and we will take a look at how to do so.</p>

<h2 id="principles-of-experimental-design">Principles of experimental design</h2>
<p>When designing an experiment, you should keep in mind three fundamental
principles:</p>
<ul>
  <li>randomization</li>
  <li>replication</li>
  <li>blocking</li>
</ul>

<p>When we talk about <strong>randomization</strong>, we refer to the random assignment of the
experimental units to different treatment condition.
Randomization allows you to reduce the systematic error, and any other residual
variation in the experimental procedure is random by construction.</p>

<p><strong>Replication</strong> is the repetition of the experimental procedure,
from the preparation to the measurement.
The purpose of replication is to have a reliable estimate of the variance,
and without replication your effect estimate might not be reliable.</p>

<p><strong>Blocking</strong> refers to fixing (when possible) or measuring (otherwise)
any factor which might reasonably affect the experimental outcome.
Controlling for external factors which might affect our measurement
helps us in identifying the sources of variability in the outcome,
and therefore will give us a more precise estimate of the effect.</p>

<h2 id="completely-randomized-design">Completely randomized design</h2>

<p>In a completely randomized experiment we assign the treatment to each experimental
unit completely at random.
In the simplest version of this design, we have $n \times k$ units,
and we want to randomly assign each unit to one of $n$ treatments.</p>

<p>As an example, consider the dataset at <a href="https://www.itl.nist.gov/div898/software/dataplot/data/BOXBLOOD.DAT">this link</a>.
The aim of the experiment is to determine whether different diets
had different effects on the blood coagulation time.
The example is taken from page 155 of <a href="https://pages.stat.wisc.edu/~yxu/Teaching/16%20spring%20Stat602/%5BGeorge_E._P._Box,_J._Stuart_Hunter,_William_G._Hu(BookZZ.org).pdf">this textbook</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="n">pm</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="n">az</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/coagulation.csv'</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Y'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'X1'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/statistics/experiment_design/coagulation_boxplot.webp" alt="The boxplot of the
coagulation dataset" /></p>

<p>In the dataset we have 24 units, and to each unit we want to assign
one of the four possible treatments.
This could have been done by running</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span><span class="o">=</span><span class="mi">4</span>
<span class="n">k</span><span class="o">=</span><span class="mi">6</span>

<span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">))</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">k</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</code></pre></div></div>

<p>We have different way to analyze this dataset, and we will use the following
model</p>

\[\begin{align}
&amp;
y_{ij} \sim \mathcal{N}(\mu_i, \sigma)
\\
&amp;
\sigma \sim \mathcal{HN}(0, 100)
\\
&amp;
\mu_i \sim \mathcal{N}(0, 100)
\end{align}\]

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">pm</span><span class="p">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">coag_model</span><span class="p">:</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">Normal</span><span class="p">(</span><span class="s">'mu'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="s">'sigma'</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">Normal</span><span class="p">(</span><span class="s">'y'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'X1'</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'Y'</span><span class="p">])</span>
    <span class="n">idata</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nuts_sampler</span><span class="o">=</span><span class="s">'numpyro'</span><span class="p">,</span> <span class="n">draws</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">az</span><span class="p">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/statistics/experiment_design/coagulation_trace.webp" alt="The trace of the
coagulation model" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">az</span><span class="p">.</span><span class="n">plot_forest</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s">'mu'</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/statistics/experiment_design/coagulation_forest.webp" alt="The forest plot of the
means for the coagulation model" /></p>

<p>There is no doubt that, in this study, we observe that a diet variation
corresponds to a coagulation time variation.</p>

<h2 id="randomized-block-design">Randomized block design</h2>
<p>In a randomized block design, we furthermore block one or more
factor (confounder) which may be a source of variability for
the outcome.
As an example, let us consider the example in chapter 4.2 of the same book.
In this experiment the authors compared the penicillin yield
of different processes (formulas).
The yield does not only depend on the process, but also on the
ingredients, so the authors used one of the main ingredients,
the corn steep liquor, as blocking factor.
The corresponding dataset can be found <a href="https://www.itl.nist.gov/div898/software/dataplot/data/BOXPENIC.DAT">here</a>.</p>

<p>In order to analyze this dataset, we will use the following model</p>

\[\begin{align}
&amp;
y_{ijk} \sim \mathcal{N}(\mu_i + \tau_j, \sigma)
\\
&amp;
\sigma \sim \mathcal{HN}(0, 100)
\\
&amp;
\mu_i \sim \mathcal{N}(0, 100)
\\
&amp;
\tau_j \sim \mathcal{N}(0, \rho)
\\
&amp;
\rho \sim \mathcal{HN}(0, 100)
\end{align}\]

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_rbd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/penicillin.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">pm</span><span class="p">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">crb_model</span><span class="p">:</span>
    
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">Normal</span><span class="p">(</span><span class="s">'mu'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">HalfCauchy</span><span class="p">(</span><span class="s">'rho'</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">Normal</span><span class="p">(</span><span class="s">'tau'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="s">'sigma'</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">Normal</span><span class="p">(</span><span class="s">'y'</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">[</span><span class="n">df_rbd</span><span class="p">[</span><span class="s">'T'</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">tau</span><span class="p">[</span><span class="n">df_rbd</span><span class="p">[</span><span class="s">'X'</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">df_rbd</span><span class="p">[</span><span class="s">'Y'</span><span class="p">])</span>
    <span class="n">idata_rbd</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nuts_sampler</span><span class="o">=</span><span class="s">'numpyro'</span><span class="p">,</span> <span class="n">draws</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">target_accept</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>

<span class="n">az</span><span class="p">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">idata_rbd</span><span class="p">)</span>
</code></pre></div></div>

<p>As we can clearly see, the ‘X’ effect has average zero, therefore
$\mu$ correctly estimates the average treatment effect.</p>

<p><img src="/docs/assets/images/statistics/experiment_design/penicillin_trace.webp" alt="The trace plot of the
means for the penicillin model" /></p>

<p>We can now take a better look at the values of $\mu$</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">az</span><span class="p">.</span><span class="n">plot_forest</span><span class="p">(</span><span class="n">idata_rbd</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s">'mu'</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/statistics/experiment_design/penicillin_forest.webp" alt="The forest plot of the
means for the penicillin model" /></p>

<p>As you can see, the treatment 2 gives slightly higher yields with respect to the
other treatment.</p>

<h2 id="matched-pairs-design">Matched pairs design</h2>

<p>The matched pairs design can be considered a special case of the randomized block design.
Rather than randomly assigning each unit to one of two groups, we first pair
units with similar relevant features, and then we toss a coin to decide which element
of the pair belongs to which group.</p>

<p>This kind of pairing can be useful when we have small samples or if we have very similar
pairs of units, such as twins.</p>

<h2 id="latin-square-design">Latin square design</h2>

<p>In the randomized block design, one can only control for one factor, but it may also be the case
that you need to control for more than one factor.
The latin square design is useful when you need to control for two factors.
This design can be visualized by drawing an $n\times n$ table, where each row corresponds
to the level of one factor, the other level is represented by the column, and each matrix element
is represented by a number $1,…,n$ or by a (latin) letter.
In a latin square, no letter can appear twice in any row or column.</p>

<p>All the possible $2\times 2$ latin squares are</p>

\[\begin{pmatrix}
1 &amp; 2 \\
2 &amp; 1 \\
\end{pmatrix},
\begin{pmatrix}
2 &amp; 1 \\
1 &amp; 2 \\
\end{pmatrix}\]

<p>while a possible $3\times 3$ latin square is</p>

\[\begin{pmatrix}
1 &amp; 2 &amp; 3 \\
2 &amp; 3 &amp; 1 \\
3 &amp; 1 &amp; 2 \\
\end{pmatrix}\]

<h2 id="conclusions">Conclusions</h2>

<p>We have discussed how to adapt some classical model used in experimental
design to make them Bayesian, and we have done so by using PyMC.</p>

  </div><a class="u-url" href="/statistics/experiment_design" hidden></a>

  <div>
          
          
  </div>

  <br>
  <div id='autograph'>
          Stippe Jun 2, 2024

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>


  <div class="wrapper">
          <div class='footer-text'>

                  No AI were harmed in creating this blog.
                  <br>
                  This is a blog, not a bakery: there are no cookies here!
                  <br>
                  The top image has been generated with a modified version Dan Gries' code, available at <a href="http://rectangleworld.com/blog/archives/538">http://rectangleworld.com</a>.
          </div>
          <br>

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Data-perspectives</li>
          <li><a class="u-email" href="mailto:dataperspectivesblog@gmail.com">dataperspectivesblog@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://twitter.com/SteffPy" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://stackoverflow.com/users/11065831/stefano" target="_blank" title="stackoverflow">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#stackoverflow"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://github.com/thestippe/" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://vis.social/@thestippe" target="_blank" title="mastodon">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#mastodon"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

  <script src="/docs/assets/javascript/scroll.js">
  </script>

</html>

