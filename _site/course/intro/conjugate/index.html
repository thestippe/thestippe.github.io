<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Conjugate models | Just another Bayesian enthusiast</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Conjugate models" />
<meta name="author" content="Stippe" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We previously mentioned the concept of conjugate models, in this post we will have a deeper look at this kind of model." />
<meta property="og:description" content="We previously mentioned the concept of conjugate models, in this post we will have a deeper look at this kind of model." />
<link rel="canonical" href="http://localhost:4000/course/intro/conjugate/" />
<meta property="og:url" content="http://localhost:4000/course/intro/conjugate/" />
<meta property="og:site_name" content="Just another Bayesian enthusiast" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-20T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Conjugate models" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Stippe"},"dateModified":"2023-08-20T00:00:00+02:00","datePublished":"2023-08-20T00:00:00+02:00","description":"We previously mentioned the concept of conjugate models, in this post we will have a deeper look at this kind of model.","headline":"Conjugate models","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/course/intro/conjugate/"},"url":"http://localhost:4000/course/intro/conjugate/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Just another Bayesian enthusiast" />

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Just another Bayesian enthusiast</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about">About me</a><a class="page-link" href="/index">Home</a><a class="page-link" href="/links">Some useful resources</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Conjugate models</h1>
    <p class="post-meta"><time class="dt-published" datetime="2023-08-20T00:00:00+02:00" itemprop="datePublished">
        Aug 20, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>We previously mentioned the concept of conjugate models, in this
post we will have a deeper look at this kind of model.</p>

<h2 id="the-beta-binomial-model-as-conjugate-model">The Beta-Binomial model as conjugate model</h2>

<p>Let us consider again the binomial model with uniform prior:</p>

\[\begin{align}
&amp;
y \sim Binomial(\theta, n) \\
&amp;
\theta \sim Uniform(0, 1)
\end{align}\]

<p>so</p>

\[p(y | \theta) \propto \theta^y (1-\theta)^{n-y}\]

<p>and, since the prior does not depend on $\theta\,,$ we have that</p>

\[p(\theta) \propto 1\]

<p>by using Bayes theorem we have that</p>

\[p(\theta | y) \propto p(y | \theta) p(\theta) \propto \theta^y (1-\theta)^{n-y}\]

<p>We can now consider a more general family of prior distribution,
namely the Beta distribution:</p>

\[p(\theta | \alpha, \beta) \propto \theta^{\alpha-1} (1-\theta)^{\beta-1}\,.\]

<p>If we take this as a prior and we use the Bayes theorem</p>

\[p(\theta | y, \alpha, \beta) \propto p(y |\theta, \alpha, \beta) p(\theta | \alpha, \beta)
\propto \theta^{y} (1-\theta)^{n-y} \theta^{\alpha-1} (1-\theta)^{\beta-1}
\propto \theta^{\alpha+y-1} (1-\theta)^{\beta+n-y-1}\]

<p>From the last formula we see that the posterior distribution has the same
form of the prior distribution. In this case we say that the
Beta distribution is a conjugate prior of the Binomial distribution.</p>

<p>By normalizing the distribution to one, we get</p>

\[p(\theta | y, \alpha, \beta) = \frac{1}{B(\alpha+y, \beta+n-y)}
\theta^{\alpha+y-1} (1-\theta)^{\beta+n-y-1}\]

<p>or, equivalently,</p>

\[\theta | y, \alpha, \beta \sim Beta(\alpha+y, \beta+n-y)\,.\]

<p>Up to the middle of the last century, conjugate models were widely
used in Bayesian statistics, as it was the only kind of analytically solvable
model.
However, nowadays, one can build and study any kind of model, thanks
to the MCMC sampling techniques.
It is however very useful to have some knowledge about conjugate models.</p>

<p>When you develop complex models, the assessment of a prior distribution
can be a tough task.
Conjugate models will allow you to make an educated guess on your prior,
since it is very easy to understand how does the data affect the posterior.</p>

<h2 id="an-application-of-conjugate-models">An application of conjugate models</h2>

<p>As an example, let us assume your friend who likes fooling
people.
Your friend has a coin, and he claims it is a fair coin within very high approximation.
He suggests to toss the coin 10 times to see if the coin is fair.
You decide that you will use a beta-binomial model to analyze the data.
You don’t know if the coin is more likely to give head or tail, so your
conjugate model will have $\alpha = \beta\,.$</p>

<p>You decide to choose $\alpha$ in such a way that, if you get 5 times head
and 5 times tail, then the $80\%$ of the posterior should lay between 0.25 and 0.75.</p>

<p>Your friend tells you that it really looks a too stringent constraint, and h</p>

<p>We can then find $\alpha$ by using the following graphics:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">plt</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="sh">"</span><span class="s">seaborn-v0_8-darkgrid</span><span class="sh">"</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nf">beta</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">).</span><span class="nf">cdf</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nf">beta</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">).</span><span class="nf">cdf</span><span class="p">(</span><span class="mf">0.75</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/docs/assets/images/conjugate/conjugate.jpg" alt="Alt text" /></p>

<p>The point where the cumulative distribution functions
evaluated at $0.25$ ($0.75$) passes through $0.1$ ($0.9$),
represents $\alpha-5\,.$
This happens approximately at $x=3$, so $\alpha=-2$ is a good prior
(we don’t need to <em>precisely</em> choose alpha, a graphical method is thus sufficient).
You should keep in mind that this prior is not a proper
prior, as it does not integrate to 1.
This is not a problem, but you should be careful in
using it and always underline this when writing
your reports.</p>

<p>If you want to have a list of the most common conjugate models, take
a look at <a href="https://en.wikipedia.org/wiki/Conjugate_prior">this</a> Wikipedia page,
while an exhaustive discussion about this kind of models can be fount
in Andrew Gelman’s textbook (see the <a href="/links/">resources</a> page).</p>

<h2 id="conclusions-and-take-home-message">Conclusions and take-home message</h2>
<ul>
  <li>Conjugate models allow you to have an analytical way to link your parameters to observable quantities</li>
  <li>You can easily formulate a constraint on your priors in terms of effects on the posteriors (I choose my prior in such a way that, f I see this outcome I want my posterior to behave this way).</li>
  <li>Priors chosen in terms of effects on the posterior are very easy to understand, criticize and, if necessary, improve.</li>
</ul>

  </div><a class="u-url" href="/course/intro/conjugate/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Stippe</li>
          <li><a class="u-email" href="mailto:smaurizio87@protonmail.com">smaurizio87@protonmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://twitter.com/SteffPy" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://stackoverflow.com/users/11065831/stefano" target="_blank" title="stackoverflow">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#stackoverflow"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://github.com/thestippe/" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>

